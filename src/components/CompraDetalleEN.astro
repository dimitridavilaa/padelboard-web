---
// src/components/CompraDetalle.astro
---

<section class="compra-section">
    <div class="container">
        
        <div class="card product-card fade-up">
            
            <div class="product-info">
                <div class="pricing-toggle-wrapper">
                    <button class="toggle-btn active" id="mode-buy">BUY</button>
                    <button class="toggle-btn" id="mode-rent">RENT</button>
                </div>

                <h1>PADELBOARD SCOREBOARD</h1>
                
                <p class="description" id="main-desc">
                    <strong>Take your club to the next level.</strong> With PadelBoard, you acquire an asset that increases the value of your courts, modernizes your facilities, and offers a professional experience that builds client loyalty. You get:
                </p>

                <ul class="feature-list">
                    <li><span class="bullet"></span> 42‚Äù HD Display</li>
                    <li><span class="bullet"></span> 2 PadelBoard Sensors with pedestal</li>
                    <li><span class="bullet"></span> Universal display mount</li>
                    <li><span class="bullet"></span> Mounting kit / wired system</li>
                </ul>

                <p class="disclaimer" id="disclaimer-text"></p>

                <div class="price-block">
                    <span class="price" id="price-display">$1,190.00 USD</span>
                    <span class="tax" id="price-label">TAX NOT INCLUDED</span>
                </div>

                <div class="actions-row">
                    <div class="qty-selector">
                        <button id="btn-minus" type="button">-</button>
                        <input type="number" id="qty-input" value="1" min="1" max="99" />
                        <button id="btn-plus" type="button">+</button>
                    </div>
                    
                    <button class="btn btn-primary" id="btn-add">ADD TO CART</button>
                </div>
                
                <button class="btn btn-full-width" id="btn-pay">PAY NOW</button>
            </div>

            <div class="product-gallery">
                <div class="img-main">
                    <img src="/img/formulario.jpg" alt="Pantalla Padel Board" />
                </div>
                <div class="img-grid-bottom">
                    <img src="/img/sensor.jpg" alt="Sensor detalle" />
                    <img src="/img/paso2_app.jpg" alt="App en mano" />
                </div>
            </div>
        </div>

        <div class="card plan-card fade-up">
            
            <div class="plan-header">
                <div class="plan-title">
                    <h2 id="plan-title">PADELBOARD<br>MONTHLY PLAN</h2>
                </div>
                <div class="plan-desc">
                    The PadelBoard Monthly Plan is a required service that ensures optimal operation of your smart scoreboard and keeps the equipment warranty active. This plan guarantees that your PadelBoard always operates with the best possible experience, stability, and customization.
                </div>
                <div class="plan-price-tag" id="plan-price-display">
                    $25.00 USD<small>(per month)</small>
                </div>
            </div>

            <div class="plan-features">
                <div class="feature-row">
                    <div class="feature-name">
                        <span class="bullet"></span> 
                        <strong>System maintenance and active warranty</strong>
                    </div>
                    <div class="feature-text">
                        Continuous internal operation review, failure prevention, and scoreboard performance optimization. Hardware warranty remains valid while the plan is active.
                    </div>
                </div>
                <hr>
                <div class="feature-row">
                    <div class="feature-name">
                        <span class="bullet"></span> 
                        <strong>Full Web App Access</strong>
                    </div>
                    <div class="feature-text">
                        Configure your matches by scanning the QR code: player names, match type, golden point or advantage, side change, among other advanced options.
                    </div>
                </div>
                <hr>
                <div class="feature-row">
                    <div class="feature-name">
                        <span class="bullet"></span> 
                        <strong>Constant updates and Online Technical Support</strong>
                    </div>
                    <div class="feature-text">
                        Periodic system improvements, new features, greater stability, and updated user experience. Fast remote attention to resolve doubts, problems, or configuration assistance.
                    </div>
                </div>
                 <hr>
                <div class="feature-row">
                    <div class="feature-name">
                        <span class="bullet"></span> 
                        <strong>Ad removal and Scoreboard Customization</strong>
                    </div>
                    <div class="feature-text">
                        Your scoreboard will run ad-free, offering a more professional and clean experience. Configuration with your club's official name and colors, reinforcing visual identity.
                    </div>
                </div>
            </div>

        </div>

    </div>

    <div id="checkout-modal" class="modal-overlay hidden">
        <div class="modal-content fade-up">
            <button id="close-modal" class="close-btn">&times;</button>
            
            <div class="modal-header">
                <h3>ORDER SUMMARY</h3>
                <p>Confirm details before contacting an advisor.</p>
            </div>
    
            <div class="order-summary">
                <div class="summary-row">
                    <span>Product:</span>
                    <strong>PadelBoard Scoreboard</strong>
                </div>
                <div class="summary-row">
                    <span>Quantity:</span>
                    <strong id="modal-qty">1</strong>
                </div>
                <div class="summary-row total">
                    <span>Estimated Total:</span>
                    <strong id="modal-total">$1,190.00 USD</strong>
                </div>
            </div>
    
            <form id="checkout-form" class="checkout-form">
                <label>Your Full Name</label>
                <input type="text" id="client-name" placeholder="Name" required>
                
                <label>Club / Company Name</label>
                <input type="text" id="client-company" placeholder="Padel Center..." required>
    
                <button type="submit" class="btn-confirm">
                    CONFIRM AND REQUEST ON WHATSAPP
                    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" width="20" style="margin-left:8px">
                </button>
            </form>
            
            <p class="secure-note">üîí Your data will be sent encrypted to the sales chat.</p>
        </div>
    </div>

</section>

<script>
    import { addToCart } from '../store/cart.js';

    // --- CONFIG ---
    const WHATSAPP_NUMBER = "593987225485";
    
    // PRICES
    const BUY_PRICE = 1190;
    //const BUY_PRICE_DISCOUNT = 899; // 3+ units
    const BUY_PLAN_PRICE = 25;
    
    const RENT_INIT_FEE = 150;
    const RENT_MONTHLY = 99;
    
    let currentMode = 'buy'; 

    // DOM ELEMENTS
    const minusBtn = document.getElementById('btn-minus');
    const plusBtn = document.getElementById('btn-plus');
    const input = document.getElementById('qty-input') as HTMLInputElement; 
    
    const priceDisplay = document.getElementById('price-display');
    const priceLabel = document.getElementById('price-label');
    const mainDesc = document.getElementById('main-desc');
    const planTitle = document.getElementById('plan-title');
    const planPriceDisplay = document.getElementById('plan-price-display');
    const disclaimerText = document.getElementById('disclaimer-text');
    
    const btnModeBuy = document.getElementById('mode-buy');
    const btnModeRent = document.getElementById('mode-rent');

    const btnPay = document.getElementById('btn-pay');
    const btnAdd = document.getElementById('btn-add');

    const modal = document.getElementById('checkout-modal');
    const closeModal = document.getElementById('close-modal');
    const modalQty = document.getElementById('modal-qty');
    const modalTotal = document.getElementById('modal-total');
    const checkoutForm = document.getElementById('checkout-form');
    const clientName = document.getElementById('client-name') as HTMLInputElement;
    const clientCompany = document.getElementById('client-company') as HTMLInputElement;

    // --- LOGIC ---
    function setMode(mode: string) {
        currentMode = mode;
        const disclaimerText = document.getElementById('disclaimer-text');

        if (btnModeBuy && btnModeRent && mainDesc && priceLabel && planTitle && disclaimerText && input) {
            
            // SIEMPRE min 1
            input.min = "1";

            if(mode === 'buy') {
                // --- BUY MODE ---
                btnModeBuy.classList.add('active');
                btnModeRent.classList.remove('active');
                
                mainDesc.innerHTML = `<strong>Take your club to the next level.</strong> With PadelBoard, you acquire an asset that increases the value of your courts, modernizes your facilities, and offers a professional experience that builds client loyalty. You get:`;
                
                // Sin texto de descuento
                disclaimerText.innerHTML = ""; 
                
                priceLabel.innerText = "TAX NOT INCLUDED";                
                
            } else {
                // --- RENT MODE ---
                btnModeRent.classList.add('active');
                btnModeBuy.classList.remove('active');
                
                mainDesc.innerHTML = `<strong>Modernize your club without breaking the bank.</strong> With the Renting model, you equip your courts with state-of-the-art technology through a flexible monthly subscription that includes full support. You get:`;
                
                // Sin texto de restricci√≥n
                disclaimerText.innerHTML = "";
                
                priceLabel.innerText = "TAX NOT INCLUDED";
            }
        }
        updateCalculations();
    }

    function updateCalculations() {
        let qty = parseInt(input?.value) || 1;
        
        if (priceDisplay && planPriceDisplay) {
            if (currentMode === 'buy') {
                // --- BUY MODE ---
                let unitPrice = BUY_PRICE;
                priceDisplay.innerText = `$${unitPrice.toLocaleString('en-US', {minimumFractionDigits: 2})} USD`; 
                planPriceDisplay.innerHTML = `$${BUY_PLAN_PRICE}.00 USD<small>(per month)</small>`;
                planPriceDisplay.style.color = "var(--color-amarillo)";
                
            } else {
                // --- RENT MODE ---
                priceDisplay.innerHTML = `$${RENT_MONTHLY}.00 USD<small> /MONTH</small>`;
                planPriceDisplay.innerText = "INCLUDED";
                planPriceDisplay.style.color = "#4ade80"; 
            }
        }
    }

    // --- MODAL & WHATSAPP ---
    function openModal(e: Event) {
        e.preventDefault();
        let qty = parseInt(input?.value) || 1;
        let totalDisplay = "";
        
        if(currentMode === 'buy') {
            let unitPrice = BUY_PRICE;
            let total = unitPrice * qty;
            totalDisplay = `$${total}.00 USD (One-time Payment)`;
        } else {
            let totalInit = RENT_INIT_FEE * qty;
            totalDisplay = `$${totalInit}.00 USD (Installation Fee)`;
        }

        if(modalQty) modalQty.innerText = qty.toString();
        if(modalTotal) modalTotal.innerText = totalDisplay;
        if(modal) modal.classList.remove('hidden');
    }

    function sendToWhatsapp(e: Event) {
        e.preventDefault();
        let qty = parseInt(input?.value) || 1;
        const name = clientName ? clientName.value : "";
        const company = clientCompany ? clientCompany.value : "";

        if(!name || !company) {
            alert("Please complete your name and company");
            return;
        }

        let message = "";

        if (currentMode === 'buy') {
            let unitPrice = BUY_PRICE;
            let total = unitPrice * qty;
            
            message = `*NEW BUY ORDER* üõí\n` +
                      `üë§ Client: ${name}\nüè¢ Club: ${company}\n` +
                      `--------------------------------\n` +
                      `üî¢ Quantity: ${qty} Scoreboards\n` +
                      `üí≤ Unit Price: $${unitPrice}\n` +
                      `üí∞ *TOTAL EQUIPMENT: $${total} USD*\n` +
                      `üìÖ Software Plan: $${BUY_PLAN_PRICE}/month per unit`;
        } else {
            let totalInit = RENT_INIT_FEE * qty;
            let totalMonthly = RENT_MONTHLY * qty;

            message = `*RENTING REQUEST* üîÑ\n` +
                      `üë§ Client: ${name}\nüè¢ Club: ${company}\n` +
                      `--------------------------------\n` +
                      `üî¢ Quantity: ${qty} Scoreboards\n` +
                      `üíµ Total Installation: $${totalInit} USD\n` +
                      `üìÖ *Total Monthly Fee: $${totalMonthly} USD*\n` +
                      `(Includes Equipment + Software)`;
        }

        let encoded = encodeURIComponent(message);
        window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encoded}`, '_blank');
        if(modal) modal.classList.add('hidden');
    }

    // --- LISTENERS ---
    if(minusBtn && plusBtn && input) {
        plusBtn.addEventListener('click', () => {
            input.value = ((parseInt(input.value) || 0) + 1).toString();
            updateCalculations();
        });

        minusBtn.addEventListener('click', () => {
            let val = parseInt(input.value) || 0;
            let minLimit = 1;
            if (val > minLimit) {
                input.value = (val - 1).toString();
                updateCalculations();
            }
        });

        input.addEventListener('change', () => {
            let val = parseInt(input.value) || 0;
            let minLimit = 1;
            if(val < minLimit) input.value = minLimit.toString();
            updateCalculations();
        });
    }

    if(btnModeBuy) btnModeBuy.addEventListener('click', () => setMode('buy'));
    if(btnModeRent) btnModeRent.addEventListener('click', () => setMode('rent'));
    if (btnPay) btnPay.addEventListener('click', openModal);
    if (closeModal && modal) closeModal.addEventListener('click', () => modal.classList.add('hidden'));
    if (checkoutForm) checkoutForm.addEventListener('submit', sendToWhatsapp);
    if (modal) modal.addEventListener('click', (e) => { if(e.target === modal) modal.classList.add('hidden'); });

    // CART BUTTON
    if (btnAdd) {
        btnAdd.addEventListener('click', (e) => {
            e.preventDefault();
            const qty = parseInt(input?.value) || 1;
            let finalPrice = (currentMode === 'buy') ? (BUY_PRICE) : RENT_INIT_FEE;
            let productName = (currentMode === 'buy') ? "PadelBoard Scoreboard (Buy)" : "PadelBoard Renting Enrollment";

            addToCart({
                id: currentMode === 'buy' ? 'marcador-padelboard' : 'renting-padelboard',
                name: productName,
                price: finalPrice,
                quantity: qty,
                image: '/img/formulario.jpg'
            });
        });
    }

    // Init
    setMode('buy');
</script>

<style>
    /* --- ESTRUCTURA PRINCIPAL --- */
    .compra-section {
        padding: 40px 20px;
        background: var(--gradiente-padel);
        font-family: var(--fuente-cuerpo);
    }

    .container {
        max-width: 1100px;
        margin: 0 auto;
    }

    .card {
        background-color: rgba(12, 18, 35, 0.55); /* Azul muy transparente */
        backdrop-filter: blur(3px); /* Efecto borroso detr√°s */
        -webkit-backdrop-filter: blur(3px); /* Soporte para Safari */
        border-radius: 30px;
        padding: 40px;
        margin-bottom: 30px;
        color: white;
        /* SOLUCI√ìN 1: Esto evita que nada se salga de los bordes redondeados */
        overflow: hidden; 
        box-shadow: 0 10px 30px rgba(0,0,0,0.1); /* Un poco de sombra para profundidad */
    }

    /* --- TARJETA 1: PRODUCTO --- */
    .product-card {
        display: grid;
        /* SOLUCI√ìN 2: Ajustamos las proporciones. 
           1.2fr para texto (m√°s espacio) y 0.8fr para fotos (m√°s controlado) */
        grid-template-columns: 1.2fr 0.8fr; 
        gap: 40px;
        align-items: start; /* Alinea al inicio para que no se estire raro */
    }

    .product-info {
        /* Evita que el texto empuje el ancho m√°s de lo debido */
        min-width: 0; 
    }

    h1 {
        font-family: var(--fuente-titulos);
        font-size: 2.2rem; /* Ajustado levemente para que quepa mejor */
        margin-top: 0;
        margin-bottom: 20px;
        text-transform: uppercase;
        line-height: 1;
        color: var(--color-amarillo)
    }

    .description {
        font-size: 0.95rem;
        line-height: 1.5;
        margin-bottom: 20px;
        color: white;
    }

    /* Lista con iconos amarillos */
    .feature-list {
        list-style: none;
        padding: 0;
        margin-bottom: 20px;
    }

    .feature-list li {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
        font-weight: 700;
        font-size: 0.9rem;
    }

    .bullet {
    display: inline-block;
    width: 11px; 
    height: 11px;
    
    /* Usamos la imagen como fondo */
    background-image: url('/img/pelota-padelboard.png'); 
    
    /* Asegura que la pelotita entera quepa dentro del espacio */
    background-size: contain; 
    background-repeat: no-repeat;
    background-position: center;

    margin-right: 10px;
    flex-shrink: 0;
    }

    .disclaimer {
        font-size: 0.75rem;
        font-style: italic;
        color: #c2c2c2;
        margin-bottom: 20px;
    }

    .price-block {
        margin-bottom: 20px;
    }
    .price {
        display: block;
        font-size: 2.2rem;
        font-weight: 700;
        font-family: var(--fuente-titulos);
    }
    .tax {
        font-size: 0.8rem;
        color: #c2c2c2;
        font-weight: bold;
    }

    /* Botones y Selectores */
    .actions-row {
        display: flex;
        gap: 10px;
        margin-bottom: 15px;
        flex-wrap: wrap; /* Permite que bajen si no caben */
    }

    /* 1. Selector de Cantidad (La pastilla peque√±a) */
    .qty-selector {
        display: flex;
        align-items: center;
        background-color: var(--color-azul-claro);
        border-radius: 50px;
        padding: 0px 10px; 
        color: white;
        font-weight: bold;
        
        /* CAMBIO: Reducimos ancho m√≠nimo */
        min-width: 110px; 
        
        justify-content: space-between;
        
        /* Opcional: Altura fija para alinearlo perfecto con el bot√≥n de al lado */
        height: 42px; 
    }
    
    /* 2. El n√∫mero dentro del selector */
    #qty-input {
        background: transparent;
        border: none;
        color: white;
        font-family: var(--fuente-titulos);
        font-size: 1.2rem; 
        text-align: center;
        width: 45px;
        outline: none;
    }

    /* Truco CSS para quitar las flechas de n√∫mero nativas del navegador */
    /* Chrome, Safari, Edge, Opera */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    /* Firefox */
    input[type=number] {
      -moz-appearance: textfield;
    }

    /* 3. Botones + y - */
    .qty-selector button {
        background: none;
        border: none;
        color: white;
        font-size: 1.2rem; 
        cursor: pointer;
        padding: 0 5px;
        transition: transform 0.2s;
        display: flex;       /* Ayuda a centrar el s√≠mbolo verticalmente */
        align-items: center; /* Centrado vertical */
    }
    
    .qty-selector button:hover {
        transform: scale(1.2); /* Efecto al pasar mouse por +/- */
    }

    /* 4. Botones de Acci√≥n (Agregar al Carrito / Pagar Ahora) */
    .btn {
        border: none;
        /* CAMBIO: Reducimos el padding vertical (antes 12px) */
        padding: 0 25px; 
        border-radius: 50px;
        cursor: pointer;
        font-family: var(--fuente-titulos);
        font-size: 1.1rem; 
        letter-spacing: 1.5px;
        transition: transform 0.2s, background-color 0.2s;
        text-transform: uppercase;
        height: 42px; 
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .btn:hover {
        transform: scale(1.02);
        opacity: 0.9;
    }

    .btn-primary {
        background-color: var(--color-azul-claro);
        color: white;
        flex-grow: 1;
        text-align: center;
    }

    .btn-full-width {
        width: 100%;
        background-color: var(--color-azul-claro);
        color: white;
    }

    /* --- GALER√çA DE IM√ÅGENES (FIX CR√çTICO) --- */
    .product-gallery {
        display: flex;
        flex-direction: column;
        gap: 15px;
        /* SOLUCI√ìN 4: Forzamos a que este contenedor nunca sea m√°s ancho que su columna */
        width: 100%;
        min-width: 0; 
    }

    .product-gallery img {
        width: 100%;
        height: 100%;
        object-fit: cover; /* Esto recorta la imagen para llenar el espacio sin deformar */
        border-radius: 20px;
        display: block;
    }

    .img-main {
        /* Altura fija para la imagen grande */
        height: 320px; 
        width: 100%;
    }

    /* 1. Modifica el contenedor (quitamos el height fijo) */
    .img-grid-bottom {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        width: 100%;
        /* Quitamos el height aqu√≠ para que no cause conflictos */
        height: auto; 
    }

    .img-grid-bottom img {
        height: 204px !important; 
        width: 100%;
        object-fit: cover;
        border-radius: 20px; /* Aseguramos que mantengan el borde */
    }

    /* --- TARJETA 2: PLAN MENSUAL --- */
    .plan-card {
        padding: 0;
    }

    .plan-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 30px 40px;
        gap: 20px;
        border-bottom: 1px solid #eee;
    }

    .plan-title h2 {
        font-family: var(--fuente-titulos);
        color: var(--color-amarillo);
        margin: 0;
        font-size: 1.8rem;
        line-height: 1;
        text-transform: uppercase;
    }

    .plan-desc {
        flex: 1;
        font-size: 0.9rem;
        line-height: 1.4;
        color: white;
    }

    .plan-price-tag {
        background-color: transparent;
        color: var(--color-amarillo);
        text-shadow:  0 4px 10px rgba(0,0,0,0.3);
        padding: 6px 5px;
        font-weight: 800;
        font-size: 2rem;
        
        /* --- NUEVO: Para apilar el texto --- */
        display: inline-flex;
        flex-direction: column;  /* Uno encima del otro */
        align-items: center;     /* Centrados */
        line-height: 1;
        white-space: normal;
        margin-top: 5px;
    }

    /* Esto reduce el tama√±o del texto que pongamos dentro de <small> */
    .plan-price-tag small {
        font-size: 0.5em; /* 50% del tama√±o del precio */
        opacity: 0.9;
        font-weight: 600;
        margin-top: 5px;
    }

    .plan-features {
        padding: 30px 40px;
    }

    .feature-row {
        display: grid;
        grid-template-columns: 1.5fr 3fr; 
        gap: 20px;
        padding: 15px 0;
    }

    .feature-name {
        display: flex;
        align-items: center;
        font-size: 0.95rem;
        color: white;
    }

    .feature-text {
        font-size: 0.9rem;
        color: whitesmoke;
    }

    hr {
        border: 0;
        border-top: 1px solid #e0e0e0;
        margin: 0;
    }

    /* --- ESTILOS DEL MODAL DE CHECKOUT --- */
.modal-overlay {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(4, 19, 62, 0.85); /* Fondo azul oscuro semitransparente */
    backdrop-filter: blur(5px); /* Efecto borroso moderno */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    opacity: 1;
    transition: opacity 0.3s ease;
}

.modal-overlay.hidden {
    opacity: 0;
    pointer-events: none; /* No se puede hacer clic si est√° oculto */
}

.modal-content {
    background: white;
    padding: 40px;
    border-radius: 20px;
    width: 90%;
    max-width: 450px;
    position: relative;
    box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    text-align: center;
}

.close-btn {
    position: absolute;
    top: 15px; right: 20px;
    background: none; border: none;
    font-size: 2rem; cursor: pointer;
    color: #666;
}

.modal-header h3 {
    font-family: var(--fuente-titulos);
    color: var(--color-azul-fondo);
    font-size: 1.8rem;
    margin-bottom: 5px;
}

.order-summary {
    background: #f4f6f9;
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
    text-align: left;
}

.summary-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    color: #555;
}

.summary-row.total {
    border-top: 1px solid #ddd;
    padding-top: 10px;
    color: var(--color-azul-fondo);
    font-size: 1.2rem;
}

/* Formulario */
.checkout-form {
    display: flex;
    flex-direction: column;
    gap: 15px;
    text-align: left;
}

.checkout-form label {
    font-weight: bold;
    font-size: 0.9rem;
    color: #333;
}

.checkout-form input {
    padding: 12px;
    border: 1px solid #ccc;
    border-radius: 8px;
    font-family: var(--fuente-cuerpo);
    font-size: 1rem;
}

.btn-confirm {
    background-color: #25D366; /* Color WhatsApp */
    color: white;
    border: none;
    padding: 15px;
    border-radius: 50px;
    font-weight: bold;
    font-size: 1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 10px;
    transition: transform 0.2s;
}

.btn-confirm:hover {
    transform: scale(1.02);
    background-color: #1ebc57;
}

.secure-note {
    font-size: 0.75rem;
    color: #999;
    margin-top: 20px;
}

/* --- TOGGLE STYLES --- */
.pricing-toggle-wrapper {
        display: flex;
        background-color: rgba(255,255,255,0.1);
        border-radius: 50px;
        padding: 5px;
        margin-bottom: 25px;
        width: fit-content;
        border: 1px solid rgba(255,255,255,0.2);
    }

    .toggle-btn {
        background: transparent;
        border: none;
        color: white;
        padding: 10px 25px;
        border-radius: 40px;
        cursor: pointer;
        font-family: var(--fuente-titulos);
        font-size: 1rem;
        letter-spacing: 1px;
        transition: all 0.3s ease;
    }

    .toggle-btn.active {
        background-color: var(--color-amarillo);
        color: black;
        box-shadow: 0 4px 15px rgba(255, 222, 89, 0.4);
    }

/* --- RESPONSIVE M√ìVIL (MODO APP NATIVA) --- */
@media (max-width: 900px) {
        /* SOLUCI√ìN ZOOM: Desactiva el zoom al tocar r√°pido botones */
        button, .btn, .qty-selector button, input {
            touch-action: manipulation; 
        }
        
        /* 1. Ajustes Generales de Espacio */
        .compra-section {
            padding: 20px 5px; /* Menos relleno lateral para ganar espacio */
        }
        
        .card {
            padding: 25px 20px; /* Tarjetas m√°s compactas */
            border-radius: 20px;
        }

        /* 2. Tarjeta de Producto (Vertical) */
        .product-card {
            grid-template-columns: 1fr; /* Una sola columna */
            gap: 25px;
        }
        
        /* Ponemos las im√°genes arriba */
        .product-gallery {
            order: -1; 
        }

        /* Imagen principal m√°s apaisada para que no empuje todo el contenido abajo */
        .img-main {
            height: 200px; 
        }
        
        /* Ocultamos las miniaturas en m√≥vil para limpiar la vista y enfocar en la venta */
        .img-grid-bottom {
            display: none; 
        }

        /* 3. Tipograf√≠a Ajustada */
        h1 {
            font-size: 1.8rem; /* T√≠tulo m√°s f√°cil de leer */
            margin-bottom: 10px;
        }
        
        .description {
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .price {
            font-size: 2.2rem; /* Precio grande y claro */
        }

        /* 4. BOTONES Y ACCIONES (LO M√ÅS IMPORTANTE) */
        .actions-row {
            flex-direction: column; /* Apilamos verticalmente */
            gap: 15px;
            width: 100%;
        }

        /* Selector de Cantidad: Grande y centrado */
        .qty-selector {
            width: 100%; 
            justify-content: space-between;
            padding: 0 30px; /* Buen espacio para los dedos */
            height: 55px; /* Altura c√≥moda para tocar */
            box-sizing: border-box;
            font-size: 1.3rem; /* N√∫meros m√°s grandes */
        }
        
        /* Botones de Acci√≥n: Ancho completo estilo App */
        .btn {
            width: 100%;
            height: 55px; /* Misma altura que el selector */
            font-size: 1rem;
            margin: 0;
        }

        /* 5. Tarjeta del Plan Mensual */
        .plan-header {
            flex-direction: column;
            padding: 20px 5px;
            gap: 15px;
        }

        .plan-features {
        padding: 20px 5px;
        }
        
        .plan-title h2 {
            font-size: 2rem;
            text-align: center;
        }

        .plan-desc {
            text-align: justify;
        }

        .feature-row {
            grid-template-columns: 1fr; /* Texto debajo del t√≠tulo */
            gap: 8px;
            text-align: left;
        }
        
        .feature-name {
            margin-bottom: 0;
            font-size: 1rem;
        }
    }
</style>